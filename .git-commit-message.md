Fix space handling in filename processing

- Replace for loop with while read to preserve spaces in filenames
- Use proper IFS handling to prevent word splitting
- Improve debug output formatting

This change fixes an issue where filenames containing spaces were being split
incorrectly during processing. The new approach using `while read` ensures that
filenames are handled as complete strings, preserving spaces and other special
characters. 